{% load static %}
{% load money %}

<div class="summary">
    <h1 class="title">
        {% firstof jewel.short_description jewel.short_description jewel.name %}
    </h1>

    <div class="card-actions">
        <button class="like-btn{% if jewel.is_liked %} liked{% endif %}"
                type="button"
                data-jewel-id="{{ jewel.id }}"
                data-url="{% url 'toggle-like' jewel.id %}"
                aria-pressed="{% if jewel.is_liked %}true{% else %}false{% endif %}"
                title="{% if jewel.is_liked %}Unlike{% else %}Like{% endif %}">
            <i class="{% if jewel.is_liked %}fas{% else %}far{% endif %} fa-heart"></i>
        </button>
    </div>

    <div class="rating-stars"
         data-avg="{{ jewel.rating_avg|default:0 }}"
         data-count="{{ jewel.rating_count|default:0 }}"
         data-my="{{ user_rating|default:'' }}"
         data-show-count="0"
         data-rate-url="{% url 'api:rate-jewel' pk=jewel.id %}"
         aria-label="Rating">
        {% for _ in "12345" %}
            <button type="button" class="star" data-value="{{ forloop.counter }}"
                    aria-label="{{ forloop.counter }} star">
                <i class="far fa-star"></i>
            </button>
        {% endfor %}
        <span class="rating-count">({{ jewel.rating_avg|default:0|floatformat:1 }}/5)</span>
    </div>

    <p class="price">
        {{ jewel.price }} BGN
        <span class="eur">({{ jewel.price|to_eur }} â‚¬)</span>
    </p>

    {% with desc=jewel.long_description|default:jewel.long_description %}
        {% if desc|length %}
            <div class="desc">{{ desc|linebreaks }}</div>
        {% else %}
            <ul class="specs">
                {% for s in jewel.specs.all %}
                    {% if s.label %}
                        <li><strong>{{ s.label }}:</strong> {{ s.value }}</li>
                    {% else %}
                        <li> {{ s.value }} </li>
                    {% endif %}
                {% empty %}
                {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}

    <div class="meta">
        <div><strong>Exchange rate:</strong> 1 EUR = {{ bgn_per_eur }} BGN</div>
        <div><strong>Availability:</strong> {% if jewel.is_available %}In stock{% else %}Made to order{% endif %}</div>
        {% if jewel.code %}
            <div><strong>Product code:</strong> {{ jewel.code }}</div>{% endif %}
    </div>
</div>
